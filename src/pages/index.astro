---
import { fetchPosts, getStrapiMediaUrl } from '../lib/strapi';

const posts = await fetchPosts();
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>My Blog</title>
  </head>
  <body>
    <h1>My Blog Posts</h1>
    
    <main>
      {posts.length > 0 ? (
        posts.map((post) => (
          <article>
            <h2>
              <a href={`/posts/${post.Slug}`}>  {/* Direct property, not post.attributes.Slug */}
                {post.Title}  {/* Direct property */}
              </a>
            </h2>
            <p>{post.Description}</p>  {/* Direct property */}
            
            {post.cover?.data && (
              <img 
                src={getStrapiMediaUrl(post.cover.data.attributes.url)}
                alt={post.Title}
                width="200"
              />
            )}
            
            <a href={`/posts/${post.Slug}`}>Read more â†’</a>
            <hr />
          </article>
        ))
      ) : (
        <p>No blog posts found.</p>
      )}
    </main>
  </body>
</html>